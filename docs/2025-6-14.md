# 2025-6-14

## 自定义 jackson

- https://zhuanlan.zhihu.com/p/4113852366

## spring boot test

- https://www.cnblogs.com/gongchengship/p/18540901
- https://www.cnblogs.com/didispace/p/18344858
-

## IDEA 开启自动生成 serialVersionUID

- https://intellij-support.jetbrains.com/hc/en-us/community/posts/14718197525906-intellij-serialversionuid-generate

## Spring Boot 过滤器和拦截器

- https://lakshya-bansal.medium.com/step-by-step-guide-to-effectively-implementing-and-utilizing-interceptors-f25a3ec06092
- https://blog.csdn.net/yuxiangdeming/article/details/133862770

## git commit plugin

- https://docs.spring.io/spring-boot/3.4/how-to/build.html#howto.build.generate-git-info
- https://github.com/git-commit-id/git-commit-id-maven-plugin

```xml
<plugin>
    <groupId>io.github.git-commit-id</groupId>
    <artifactId>git-commit-id-maven-plugin</artifactId>
</plugin>
```

```properties
#Generated by Git-Commit-Id-Plugin
git.branch=main
git.build.host=DESKTOP-GOK7120
git.build.time=2025-05-30T08\:14\:47+08\:00
git.build.user.email=caobaoqi6040@gmail.com
git.build.user.name=caobaoqi6040
git.build.version=0.0.1-SNAPSHOT
git.closest.tag.commit.count=
git.closest.tag.name=
git.commit.author.time=2025-05-30T08\:14\:37+08\:00
git.commit.committer.time=2025-05-30T08\:14\:37+08\:00
git.commit.id=fcc251a7babe7bdf7a251529eb0105912d05806a
git.commit.id.abbrev=fcc251a
git.commit.id.describe=fcc251a
git.commit.id.describe-short=fcc251a
git.commit.message.full=\:construction\: feat(build)\: init docker image build
git.commit.message.short=\:construction\: feat(build)\: init docker image build
git.commit.time=2025-05-30T08\:14\:37+08\:00
git.commit.user.email=caobaoqi6040@gmail.com
git.commit.user.name=caobaoqi6040
git.dirty=false
git.local.branch.ahead=NO_REMOTE
git.local.branch.behind=NO_REMOTE
git.remote.origin.url=Unknown
git.tag=
git.tags=
git.total.commit.count=2
```

## disable spring boot dev tools

- https://docs.spring.io/spring-boot/3.4/reference/using/devtools.html#using.devtools.restart.disable

```java
public class SpringBoot3TemplateMavenApplication {

    public static void main(String[] args) {
        System.setProperty("spring.devtools.restart.enabled", "false");
        SpringApplication.run(SpringBoot3TemplateMavenApplication.class, args);
    }
}
```

## config cors with spring mvc

- https://juejin.cn/post/7301224822733717544?searchId=2025053023493163E5BEFAE519ECE199D5

```java
@Configuration
class WebMvcConfiguration implements WebMvcConfigurer {

	@Value("${cors.allowed-origins}")
	private String allowedOrigins;
	@Value("${cors.allowed-methods}")
	private String allowedMethods;
	@Value("${cors.allowed-headers}")
	private String allowedHeaders;
	@Value("${cors.allowed-expose-headers}")
	private String allowedExposeHeaders;

    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/**");
    }

    @Bean
    public CorsConfigurationSource corsConfigurationSource() {
        CorsConfiguration configuration = new CorsConfiguration();
        configuration.setAllowedOrigins(Arrays.asList(allowedOrigins.split(",")));
        configuration.setAllowedMethods(Arrays.asList(allowedMethods.split(",")));
        configuration.setAllowedHeaders(Arrays.asList(allowedHeaders.split(",")));
        configuration.setExposedHeaders(Arrays.asList(allowedExposeHeaders.split(",")));
        configuration.setAllowCredentials(true);
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        source.registerCorsConfiguration("/**", configuration);
        return source;
    }
    
```

## global exception(RFC 9457)

- https://www.bilibili.com/video/BV1DHypYAEHT/?p=1

```java
@Slf4j
@RestControllerAdvice
public class GlobalExceptionHandler extends ResponseEntityExceptionHandler {

	@ExceptionHandler(value = {BusinessException.class})
	public ResponseEntity<Object> handleBusinessException(BusinessException ex, WebRequest request) {
		logger.error("========== Handled Business Exception ==========", ex);
		ProblemDetail detail = ProblemDetail.forStatusAndDetail(HttpStatus.INTERNAL_SERVER_ERROR, ex.getMessage());
		ErrorResponseException errorResponseException = new ErrorResponseException(HttpStatus.INTERNAL_SERVER_ERROR, detail, ex.getCause());
		return handleExceptionInternal(
			errorResponseException,
			errorResponseException.getBody(),
			errorResponseException.getHeaders(),
			errorResponseException.getStatusCode(),
			request);
	}

	@SuppressWarnings("NullableProblems")
	@Override
	@Nullable
	public ResponseEntity<Object> handleMethodArgumentNotValid(MethodArgumentNotValidException ex, HttpHeaders headers, HttpStatusCode status, WebRequest request) {
		logger.error("========== Handled MethodArgumentNotValid Exception ==========", ex);
		Map<String, String> errors = new HashMap<>();
		ex.getBindingResult().getFieldErrors().forEach(error ->
			errors.put(error.getField(), error.getDefaultMessage()));
		ProblemDetail detail = ProblemDetail.forStatusAndDetail(status, "参数校验失败");
		detail.setProperty("errors", errors);
		ErrorResponseException errorResponseException = new ErrorResponseException(status, detail, ex.getCause());
		return handleExceptionInternal(
			errorResponseException,
			errorResponseException.getBody(),
			errorResponseException.getHeaders(),
			errorResponseException.getStatusCode(),
			request);
	}

	@ExceptionHandler(value = {Throwable.class})
	public ResponseEntity<Object> handleException(Throwable ex, WebRequest request) {
		logger.error("========== Handled Exception ==========", ex);
		ErrorResponseException errorResponseException = new ErrorResponseException(HttpStatus.INTERNAL_SERVER_ERROR, ProblemDetail.forStatusAndDetail(HttpStatus.INTERNAL_SERVER_ERROR, "System Error"), ex.getCause());
		return handleExceptionInternal(
			errorResponseException,
			errorResponseException.getBody(),
			errorResponseException.getHeaders(),
			errorResponseException.getStatusCode(),
			request);
	}
}
```

```java
public class BusinessException extends RuntimeException {

	@Serial
	private static final long serialVersionUID = -6324446299169584065L;

	public BusinessException() {
	}

	public BusinessException(String message) {
		super(message);
	}

	public BusinessException(String message, Throwable cause) {
		super(message, cause);
	}

	public BusinessException(Throwable cause) {
		super(cause);
	}

	public BusinessException(
		String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace) {
		super(message, cause, enableSuppression, writableStackTrace);
	}
}

```
